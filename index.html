<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Hidrográfico Madrid</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <header class="hero">
    <div class="overlay"></div>
    <div class="hero-content">
      <p class="eyebrow">Comunidad de Madrid · Series temporales</p>
      <h1>Seguimiento de agua embalsada</h1>
      <p class="subtitle">Dashboard compacto para evaluar el riesgo de sequía en 2022 sin perder contexto histórico.</p>
      <div class="hero-images">
        <img src="https://images.unsplash.com/photo-1505761671935-60b3a7427bad?auto=format&fit=crop&w=800&q=80" alt="Embalse" />
        <img src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=800&q=80" alt="Río" />
        <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80" alt="Medidor de agua" />
      </div>
    </div>
  </header>

  <main class="container">
    <section class="cards" aria-label="Indicadores resumen">
      <article class="card">
        <p class="label">Media histórica mensual</p>
        <p class="value" id="historical-avg">--</p>
        <p class="hint">Promedio de todos los meses anteriores a 2022 (hm³).</p>
      </article>
      <article class="card">
        <p class="label">Media mensual 2022</p>
        <p class="value" id="avg-2022">--</p>
        <p class="hint">Promedio de los meses disponibles en 2022 (hm³).</p>
      </article>
      <article class="card">
        <p class="label">Diferencia vs. histórico</p>
        <p class="value" id="diff-percent">--</p>
        <p class="hint">Porcentaje por encima o por debajo de la media histórica.</p>
      </article>
      <article class="card accent" id="risk-card">
        <p class="label">Indicador de sequía 2022</p>
        <p class="value" id="risk-level">--</p>
        <p class="hint" id="risk-hint">Evaluando datos...</p>
      </article>
    </section>

    <section class="chart-section">
      <div class="section-header between">
        <div>
          <p class="eyebrow">Explora los datos</p>
          <h2>Una gráfica a la vez para un espacio pequeño</h2>
          <p class="section-subtitle">Activa la vista que necesites sin salir de la página.</p>
        </div>
        <div class="chart-controls" role="group" aria-label="Cambiar gráfica">
          <button class="control-btn active" data-view="time">Evolución</button>
          <button class="control-btn" data-view="comparison">2022 vs histórico</button>
          <button class="control-btn" data-view="monthly">Promedio mensual</button>
        </div>
      </div>
      <div class="chart-wrapper">
        <canvas id="main-chart" height="240"></canvas>
      </div>
      <p class="chart-hint" id="chart-description">Curva mensual del volumen total embalsado.</p>
    </section>

    <section class="info compact">
      <div>
        <h3>Sobre los datos</h3>
        <p>El CSV contiene registros mensuales de niveles de agua embalsada en distintos embalses de la Comunidad de Madrid. Si no existe columna <em>total</em>, el dashboard suma todas las columnas numéricas por mes.</p>
      </div>
      <div>
        <h3>Cómo interpretar</h3>
        <p>Una tendencia descendente prolongada o valores de 2022 por debajo de la media histórica sugieren riesgo de sequía. La tarjeta de riesgo resume el diferencial porcentual.</p>
      </div>
      <div>
        <h3>Conclusiones</h3>
        <p id="conclusion-text">Cargando conclusiones a partir de los datos...</p>
        <p>Verde: 2022 por encima del histórico. Ámbar: similar. Rojo: déficit notable.</p>
      </div>
    </section>
  </main>

  <footer>
    <p>Dashboard hidrográfico · Comunidad de Madrid · Datos históricos de embalses</p>
  </footer>

  <script src="script.js"></script>
</body>
</html>
